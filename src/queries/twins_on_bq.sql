# Generating the queries
select
concat(', avg(if(second.', column_name, '> 0, first.', column_name, '/second.', column_name,', null)) as ', column_name, '_avg') as avg_expr
, concat(' , stddev(if(second.', column_name, '> 0, first.', column_name, '/second.', column_name,', null)) as ', column_name, '_std') as std_expr
from
`general.INFORMATION_SCHEMA.COLUMNS`
where
table_schema = 'general'
and
table_name = 'developer_motivation_profile'
and
data_type in ('INT64', 'FLOAT64')
order by
ordinal_position
;

# into twins_continue_over_abandoned_bq.csv
select
count(*) as cases
, count(distinct first.author_email) as developers

### Automatic columns from above
, avg(if(second.year> 0, first.year/second.year, null)) as year_avg	 , stddev(if(second.year> 0, first.year/second.year, null)) as year_std
, avg(if(second.names> 0, first.names/second.names, null)) as names_avg	 , stddev(if(second.names> 0, first.names/second.names, null)) as names_std
, avg(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_avg	 , stddev(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_std
, avg(if(second.commits> 0, first.commits/second.commits, null)) as commits_avg	 , stddev(if(second.commits> 0, first.commits/second.commits, null)) as commits_std
, avg(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_avg	 , stddev(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_std
, avg(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_avg	 , stddev(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_std
, avg(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_avg	 , stddev(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_std
, avg(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_avg	 , stddev(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_std
, avg(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_avg	 , stddev(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_std
, avg(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_avg	 , stddev(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_std
, avg(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_avg	 , stddev(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_std
, avg(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_avg	 , stddev(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_std
, avg(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_avg	 , stddev(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_std
, avg(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_avg	 , stddev(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_std
, avg(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_avg	 , stddev(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_std
, avg(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_avg	 , stddev(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_std
, avg(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_avg	 , stddev(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_std
, avg(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_avg	 , stddev(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_std
, avg(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_avg	 , stddev(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_std
, avg(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_avg	 , stddev(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_std
, avg(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_avg	 , stddev(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_std
, avg(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_avg	 , stddev(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_std
, avg(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_avg	 , stddev(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_std
, avg(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_avg	 , stddev(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_std
, avg(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_avg	 , stddev(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_std
, avg(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_avg	 , stddev(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_std
, avg(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_avg	 , stddev(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_std
, avg(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_avg	 , stddev(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_std
, avg(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_avg	 , stddev(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_std
, avg(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_avg	 , stddev(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_std
, avg(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_avg	 , stddev(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_std
, avg(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_avg	 , stddev(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_std
, avg(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_avg	 , stddev(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_std
, avg(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_avg	 , stddev(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_std
, avg(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_avg	 , stddev(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_std
, avg(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_avg	 , stddev(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_std
, avg(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_avg	 , stddev(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_std
, avg(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_avg	 , stddev(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_std
, avg(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_avg	 , stddev(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_std
, avg(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_avg	 , stddev(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_std
, avg(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_avg	 , stddev(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_std
, avg(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_avg	 , stddev(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_std
, avg(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_avg	 , stddev(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_std
, avg(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_avg	 , stddev(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_std
, avg(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_avg	 , stddev(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_std
, avg(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_avg	 , stddev(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_std
, avg(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_avg	 , stddev(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_std
, avg(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_avg	 , stddev(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_std
, avg(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_avg	 , stddev(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_std
, avg(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_avg	 , stddev(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_std
, avg(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_avg	 , stddev(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_std
, avg(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_avg	 , stddev(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_std
, avg(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_avg	 , stddev(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_std
, avg(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_avg	 , stddev(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_std
, avg(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_avg	 , stddev(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_std
, avg(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_avg	 , stddev(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_std
, avg(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_avg	 , stddev(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_std
, avg(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_avg	 , stddev(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_std
, avg(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_avg	 , stddev(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_std
, avg(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_avg	 , stddev(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_std
, avg(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_avg	 , stddev(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_std
, avg(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_avg	 , stddev(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_std
, avg(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_avg	 , stddev(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_std
, avg(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_avg	 , stddev(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_std
, avg(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_avg	 , stddev(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_std
, avg(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_avg	 , stddev(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_std
, avg(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_avg	 , stddev(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_std
, avg(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_avg	 , stddev(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_std
, avg(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_avg	 , stddev(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_std
, avg(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_avg	 , stddev(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_std
, avg(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_avg	 , stddev(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_std
, avg(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_avg	 , stddev(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_std
, avg(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_avg	 , stddev(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_std
, avg(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_avg	 , stddev(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_std
, avg(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_avg	 , stddev(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_std
, avg(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_avg	 , stddev(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_std
, avg(if(second.issues> 0, first.issues/second.issues, null)) as issues_avg	 , stddev(if(second.issues> 0, first.issues/second.issues, null)) as issues_std
, avg(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_avg	 , stddev(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_std
, avg(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_avg	 , stddev(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_std
, avg(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_avg	 , stddev(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_std
, avg(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_avg	 , stddev(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_std
, avg(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_avg	 , stddev(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_std
, avg(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_avg	 , stddev(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_std
, avg(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_avg	 , stddev(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_std
, avg(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_avg	 , stddev(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_std
, avg(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_avg	 , stddev(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_std
, avg(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_avg	 , stddev(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_std
, avg(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_avg	 , stddev(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_std
, avg(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_avg	 , stddev(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_std
, avg(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_avg	 , stddev(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_std
, avg(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_avg	 , stddev(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_std
, avg(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_avg	 , stddev(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_std
, avg(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_avg	 , stddev(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_std
, avg(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_avg	 , stddev(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_std
, avg(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_avg	 , stddev(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_std
, avg(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_avg	 , stddev(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_std
, avg(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_avg	 , stddev(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_std
, avg(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_avg	 , stddev(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_std
, avg(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_avg	 , stddev(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_std
, avg(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_avg	 , stddev(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_std
, avg(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_avg	 , stddev(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_std
, avg(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_avg	 , stddev(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_std
, avg(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_avg	 , stddev(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_std
from
general.developer_motivation_profile as first
join
general.developer_motivation_profile as second
on
first.author_email = second.author_email
and
first.year = second.year
and
first.repo_name <> second.repo_name
where
first.status = 'Continue'
and
second.status = 'Abandoned'
;

# into twins_continue_over_continue_bq.csv
select
count(*) as cases
, count(distinct first.author_email) as developers

### Automatic columns from above
, avg(if(second.year> 0, first.year/second.year, null)) as year_avg	 , stddev(if(second.year> 0, first.year/second.year, null)) as year_std
, avg(if(second.names> 0, first.names/second.names, null)) as names_avg	 , stddev(if(second.names> 0, first.names/second.names, null)) as names_std
, avg(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_avg	 , stddev(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_std
, avg(if(second.commits> 0, first.commits/second.commits, null)) as commits_avg	 , stddev(if(second.commits> 0, first.commits/second.commits, null)) as commits_std
, avg(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_avg	 , stddev(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_std
, avg(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_avg	 , stddev(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_std
, avg(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_avg	 , stddev(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_std
, avg(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_avg	 , stddev(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_std
, avg(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_avg	 , stddev(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_std
, avg(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_avg	 , stddev(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_std
, avg(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_avg	 , stddev(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_std
, avg(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_avg	 , stddev(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_std
, avg(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_avg	 , stddev(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_std
, avg(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_avg	 , stddev(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_std
, avg(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_avg	 , stddev(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_std
, avg(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_avg	 , stddev(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_std
, avg(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_avg	 , stddev(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_std
, avg(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_avg	 , stddev(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_std
, avg(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_avg	 , stddev(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_std
, avg(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_avg	 , stddev(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_std
, avg(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_avg	 , stddev(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_std
, avg(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_avg	 , stddev(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_std
, avg(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_avg	 , stddev(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_std
, avg(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_avg	 , stddev(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_std
, avg(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_avg	 , stddev(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_std
, avg(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_avg	 , stddev(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_std
, avg(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_avg	 , stddev(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_std
, avg(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_avg	 , stddev(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_std
, avg(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_avg	 , stddev(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_std
, avg(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_avg	 , stddev(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_std
, avg(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_avg	 , stddev(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_std
, avg(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_avg	 , stddev(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_std
, avg(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_avg	 , stddev(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_std
, avg(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_avg	 , stddev(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_std
, avg(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_avg	 , stddev(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_std
, avg(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_avg	 , stddev(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_std
, avg(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_avg	 , stddev(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_std
, avg(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_avg	 , stddev(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_std
, avg(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_avg	 , stddev(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_std
, avg(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_avg	 , stddev(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_std
, avg(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_avg	 , stddev(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_std
, avg(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_avg	 , stddev(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_std
, avg(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_avg	 , stddev(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_std
, avg(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_avg	 , stddev(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_std
, avg(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_avg	 , stddev(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_std
, avg(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_avg	 , stddev(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_std
, avg(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_avg	 , stddev(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_std
, avg(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_avg	 , stddev(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_std
, avg(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_avg	 , stddev(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_std
, avg(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_avg	 , stddev(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_std
, avg(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_avg	 , stddev(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_std
, avg(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_avg	 , stddev(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_std
, avg(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_avg	 , stddev(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_std
, avg(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_avg	 , stddev(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_std
, avg(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_avg	 , stddev(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_std
, avg(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_avg	 , stddev(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_std
, avg(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_avg	 , stddev(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_std
, avg(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_avg	 , stddev(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_std
, avg(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_avg	 , stddev(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_std
, avg(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_avg	 , stddev(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_std
, avg(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_avg	 , stddev(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_std
, avg(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_avg	 , stddev(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_std
, avg(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_avg	 , stddev(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_std
, avg(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_avg	 , stddev(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_std
, avg(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_avg	 , stddev(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_std
, avg(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_avg	 , stddev(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_std
, avg(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_avg	 , stddev(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_std
, avg(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_avg	 , stddev(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_std
, avg(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_avg	 , stddev(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_std
, avg(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_avg	 , stddev(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_std
, avg(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_avg	 , stddev(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_std
, avg(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_avg	 , stddev(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_std
, avg(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_avg	 , stddev(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_std
, avg(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_avg	 , stddev(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_std
, avg(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_avg	 , stddev(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_std
, avg(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_avg	 , stddev(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_std
, avg(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_avg	 , stddev(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_std
, avg(if(second.issues> 0, first.issues/second.issues, null)) as issues_avg	 , stddev(if(second.issues> 0, first.issues/second.issues, null)) as issues_std
, avg(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_avg	 , stddev(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_std
, avg(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_avg	 , stddev(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_std
, avg(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_avg	 , stddev(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_std
, avg(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_avg	 , stddev(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_std
, avg(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_avg	 , stddev(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_std
, avg(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_avg	 , stddev(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_std
, avg(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_avg	 , stddev(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_std
, avg(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_avg	 , stddev(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_std
, avg(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_avg	 , stddev(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_std
, avg(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_avg	 , stddev(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_std
, avg(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_avg	 , stddev(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_std
, avg(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_avg	 , stddev(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_std
, avg(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_avg	 , stddev(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_std
, avg(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_avg	 , stddev(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_std
, avg(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_avg	 , stddev(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_std
, avg(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_avg	 , stddev(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_std
, avg(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_avg	 , stddev(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_std
, avg(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_avg	 , stddev(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_std
, avg(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_avg	 , stddev(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_std
, avg(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_avg	 , stddev(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_std
, avg(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_avg	 , stddev(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_std
, avg(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_avg	 , stddev(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_std
, avg(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_avg	 , stddev(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_std
, avg(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_avg	 , stddev(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_std
, avg(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_avg	 , stddev(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_std
, avg(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_avg	 , stddev(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_std
from
general.developer_motivation_profile as first
join
general.developer_motivation_profile as second
on
first.author_email = second.author_email
and
first.year = second.year
and
first.repo_name <> second.repo_name
where
first.status = 'Continue'
and
second.status = 'Continue'
;


# into twins_no_activity_over_continue_bq.csv
select
count(*) as cases
, count(distinct first.author_email) as developers

### Automatic columns from above
, avg(if(second.year> 0, first.year/second.year, null)) as year_avg	 , stddev(if(second.year> 0, first.year/second.year, null)) as year_std
, avg(if(second.names> 0, first.names/second.names, null)) as names_avg	 , stddev(if(second.names> 0, first.names/second.names, null)) as names_std
, avg(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_avg	 , stddev(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_std
, avg(if(second.commits> 0, first.commits/second.commits, null)) as commits_avg	 , stddev(if(second.commits> 0, first.commits/second.commits, null)) as commits_std
, avg(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_avg	 , stddev(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_std
, avg(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_avg	 , stddev(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_std
, avg(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_avg	 , stddev(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_std
, avg(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_avg	 , stddev(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_std
, avg(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_avg	 , stddev(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_std
, avg(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_avg	 , stddev(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_std
, avg(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_avg	 , stddev(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_std
, avg(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_avg	 , stddev(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_std
, avg(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_avg	 , stddev(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_std
, avg(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_avg	 , stddev(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_std
, avg(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_avg	 , stddev(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_std
, avg(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_avg	 , stddev(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_std
, avg(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_avg	 , stddev(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_std
, avg(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_avg	 , stddev(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_std
, avg(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_avg	 , stddev(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_std
, avg(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_avg	 , stddev(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_std
, avg(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_avg	 , stddev(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_std
, avg(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_avg	 , stddev(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_std
, avg(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_avg	 , stddev(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_std
, avg(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_avg	 , stddev(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_std
, avg(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_avg	 , stddev(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_std
, avg(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_avg	 , stddev(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_std
, avg(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_avg	 , stddev(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_std
, avg(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_avg	 , stddev(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_std
, avg(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_avg	 , stddev(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_std
, avg(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_avg	 , stddev(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_std
, avg(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_avg	 , stddev(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_std
, avg(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_avg	 , stddev(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_std
, avg(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_avg	 , stddev(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_std
, avg(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_avg	 , stddev(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_std
, avg(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_avg	 , stddev(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_std
, avg(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_avg	 , stddev(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_std
, avg(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_avg	 , stddev(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_std
, avg(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_avg	 , stddev(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_std
, avg(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_avg	 , stddev(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_std
, avg(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_avg	 , stddev(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_std
, avg(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_avg	 , stddev(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_std
, avg(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_avg	 , stddev(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_std
, avg(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_avg	 , stddev(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_std
, avg(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_avg	 , stddev(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_std
, avg(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_avg	 , stddev(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_std
, avg(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_avg	 , stddev(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_std
, avg(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_avg	 , stddev(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_std
, avg(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_avg	 , stddev(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_std
, avg(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_avg	 , stddev(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_std
, avg(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_avg	 , stddev(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_std
, avg(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_avg	 , stddev(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_std
, avg(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_avg	 , stddev(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_std
, avg(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_avg	 , stddev(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_std
, avg(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_avg	 , stddev(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_std
, avg(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_avg	 , stddev(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_std
, avg(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_avg	 , stddev(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_std
, avg(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_avg	 , stddev(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_std
, avg(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_avg	 , stddev(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_std
, avg(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_avg	 , stddev(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_std
, avg(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_avg	 , stddev(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_std
, avg(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_avg	 , stddev(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_std
, avg(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_avg	 , stddev(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_std
, avg(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_avg	 , stddev(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_std
, avg(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_avg	 , stddev(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_std
, avg(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_avg	 , stddev(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_std
, avg(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_avg	 , stddev(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_std
, avg(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_avg	 , stddev(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_std
, avg(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_avg	 , stddev(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_std
, avg(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_avg	 , stddev(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_std
, avg(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_avg	 , stddev(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_std
, avg(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_avg	 , stddev(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_std
, avg(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_avg	 , stddev(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_std
, avg(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_avg	 , stddev(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_std
, avg(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_avg	 , stddev(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_std
, avg(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_avg	 , stddev(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_std
, avg(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_avg	 , stddev(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_std
, avg(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_avg	 , stddev(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_std
, avg(if(second.issues> 0, first.issues/second.issues, null)) as issues_avg	 , stddev(if(second.issues> 0, first.issues/second.issues, null)) as issues_std
, avg(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_avg	 , stddev(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_std
, avg(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_avg	 , stddev(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_std
, avg(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_avg	 , stddev(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_std
, avg(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_avg	 , stddev(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_std
, avg(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_avg	 , stddev(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_std
, avg(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_avg	 , stddev(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_std
, avg(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_avg	 , stddev(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_std
, avg(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_avg	 , stddev(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_std
, avg(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_avg	 , stddev(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_std
, avg(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_avg	 , stddev(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_std
, avg(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_avg	 , stddev(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_std
, avg(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_avg	 , stddev(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_std
, avg(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_avg	 , stddev(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_std
, avg(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_avg	 , stddev(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_std
, avg(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_avg	 , stddev(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_std
, avg(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_avg	 , stddev(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_std
, avg(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_avg	 , stddev(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_std
, avg(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_avg	 , stddev(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_std
, avg(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_avg	 , stddev(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_std
, avg(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_avg	 , stddev(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_std
, avg(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_avg	 , stddev(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_std
, avg(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_avg	 , stddev(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_std
, avg(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_avg	 , stddev(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_std
, avg(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_avg	 , stddev(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_std
, avg(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_avg	 , stddev(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_std
, avg(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_avg	 , stddev(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_std
from
general.developer_motivation_profile as first
join
general.developer_motivation_profile as second
on
first.author_email = second.author_email
and
abs(first.year - second.year) <=1 # NOTE - there are no pairs in the same year (interesting on its own) so the condition is relaxed here
and
first.repo_name <> second.repo_name
where
first.status = 'No activity'
and
second.status = 'Continue'
;

# into twins_next_over_prev_bq.csv
select
count(*) as cases
, count(distinct first.author_email) as developers

### Automatic columns from above
, avg(if(second.year> 0, first.year/second.year, null)) as year_avg	 , stddev(if(second.year> 0, first.year/second.year, null)) as year_std
, avg(if(second.names> 0, first.names/second.names, null)) as names_avg	 , stddev(if(second.names> 0, first.names/second.names, null)) as names_std
, avg(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_avg	 , stddev(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_std
, avg(if(second.commits> 0, first.commits/second.commits, null)) as commits_avg	 , stddev(if(second.commits> 0, first.commits/second.commits, null)) as commits_std
, avg(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_avg	 , stddev(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_std
, avg(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_avg	 , stddev(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_std
, avg(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_avg	 , stddev(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_std
, avg(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_avg	 , stddev(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_std
, avg(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_avg	 , stddev(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_std
, avg(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_avg	 , stddev(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_std
, avg(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_avg	 , stddev(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_std
, avg(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_avg	 , stddev(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_std
, avg(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_avg	 , stddev(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_std
, avg(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_avg	 , stddev(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_std
, avg(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_avg	 , stddev(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_std
, avg(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_avg	 , stddev(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_std
, avg(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_avg	 , stddev(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_std
, avg(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_avg	 , stddev(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_std
, avg(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_avg	 , stddev(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_std
, avg(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_avg	 , stddev(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_std
, avg(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_avg	 , stddev(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_std
, avg(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_avg	 , stddev(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_std
, avg(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_avg	 , stddev(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_std
, avg(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_avg	 , stddev(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_std
, avg(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_avg	 , stddev(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_std
, avg(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_avg	 , stddev(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_std
, avg(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_avg	 , stddev(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_std
, avg(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_avg	 , stddev(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_std
, avg(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_avg	 , stddev(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_std
, avg(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_avg	 , stddev(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_std
, avg(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_avg	 , stddev(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_std
, avg(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_avg	 , stddev(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_std
, avg(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_avg	 , stddev(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_std
, avg(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_avg	 , stddev(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_std
, avg(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_avg	 , stddev(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_std
, avg(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_avg	 , stddev(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_std
, avg(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_avg	 , stddev(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_std
, avg(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_avg	 , stddev(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_std
, avg(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_avg	 , stddev(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_std
, avg(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_avg	 , stddev(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_std
, avg(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_avg	 , stddev(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_std
, avg(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_avg	 , stddev(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_std
, avg(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_avg	 , stddev(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_std
, avg(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_avg	 , stddev(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_std
, avg(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_avg	 , stddev(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_std
, avg(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_avg	 , stddev(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_std
, avg(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_avg	 , stddev(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_std
, avg(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_avg	 , stddev(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_std
, avg(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_avg	 , stddev(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_std
, avg(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_avg	 , stddev(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_std
, avg(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_avg	 , stddev(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_std
, avg(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_avg	 , stddev(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_std
, avg(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_avg	 , stddev(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_std
, avg(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_avg	 , stddev(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_std
, avg(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_avg	 , stddev(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_std
, avg(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_avg	 , stddev(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_std
, avg(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_avg	 , stddev(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_std
, avg(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_avg	 , stddev(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_std
, avg(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_avg	 , stddev(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_std
, avg(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_avg	 , stddev(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_std
, avg(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_avg	 , stddev(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_std
, avg(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_avg	 , stddev(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_std
, avg(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_avg	 , stddev(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_std
, avg(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_avg	 , stddev(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_std
, avg(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_avg	 , stddev(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_std
, avg(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_avg	 , stddev(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_std
, avg(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_avg	 , stddev(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_std
, avg(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_avg	 , stddev(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_std
, avg(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_avg	 , stddev(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_std
, avg(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_avg	 , stddev(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_std
, avg(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_avg	 , stddev(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_std
, avg(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_avg	 , stddev(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_std
, avg(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_avg	 , stddev(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_std
, avg(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_avg	 , stddev(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_std
, avg(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_avg	 , stddev(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_std
, avg(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_avg	 , stddev(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_std
, avg(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_avg	 , stddev(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_std
, avg(if(second.issues> 0, first.issues/second.issues, null)) as issues_avg	 , stddev(if(second.issues> 0, first.issues/second.issues, null)) as issues_std
, avg(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_avg	 , stddev(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_std
, avg(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_avg	 , stddev(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_std
, avg(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_avg	 , stddev(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_std
, avg(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_avg	 , stddev(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_std
, avg(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_avg	 , stddev(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_std
, avg(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_avg	 , stddev(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_std
, avg(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_avg	 , stddev(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_std
, avg(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_avg	 , stddev(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_std
, avg(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_avg	 , stddev(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_std
, avg(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_avg	 , stddev(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_std
, avg(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_avg	 , stddev(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_std
, avg(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_avg	 , stddev(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_std
, avg(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_avg	 , stddev(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_std
, avg(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_avg	 , stddev(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_std
, avg(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_avg	 , stddev(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_std
, avg(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_avg	 , stddev(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_std
, avg(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_avg	 , stddev(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_std
, avg(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_avg	 , stddev(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_std
, avg(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_avg	 , stddev(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_std
, avg(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_avg	 , stddev(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_std
, avg(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_avg	 , stddev(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_std
, avg(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_avg	 , stddev(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_std
, avg(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_avg	 , stddev(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_std
, avg(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_avg	 , stddev(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_std
, avg(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_avg	 , stddev(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_std
, avg(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_avg	 , stddev(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_std
from
general.developer_motivation_profile as first
join
general.developer_motivation_profile as second
on
first.author_email = second.author_email
and
first.year +1 = second.year
and
first.repo_name = second.repo_name
where
first.status = 'Continue'
;

# into twins_abandoned_over_prev_bq.csv
select
count(*) as cases
, count(distinct first.author_email) as developers

### Automatic columns from above
, avg(if(second.year> 0, first.year/second.year, null)) as year_avg	 , stddev(if(second.year> 0, first.year/second.year, null)) as year_std
, avg(if(second.names> 0, first.names/second.names, null)) as names_avg	 , stddev(if(second.names> 0, first.names/second.names, null)) as names_std
, avg(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_avg	 , stddev(if(second.owned_repository> 0, first.owned_repository/second.owned_repository, null)) as owned_repository_std
, avg(if(second.commits> 0, first.commits/second.commits, null)) as commits_avg	 , stddev(if(second.commits> 0, first.commits/second.commits, null)) as commits_std
, avg(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_avg	 , stddev(if(second.files_edited> 0, first.files_edited/second.files_edited, null)) as files_edited_std
, avg(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_avg	 , stddev(if(second.files_created> 0, first.files_created/second.files_created, null)) as files_created_std
, avg(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_avg	 , stddev(if(second.files_owned> 0, first.files_owned/second.files_owned, null)) as files_owned_std
, avg(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_avg	 , stddev(if(second.files_edited_ccp> 0, first.files_edited_ccp/second.files_edited_ccp, null)) as files_edited_ccp_std
, avg(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_avg	 , stddev(if(second.files_created_ccp> 0, first.files_created_ccp/second.files_created_ccp, null)) as files_created_ccp_std
, avg(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_avg	 , stddev(if(second.files_owned_ccp> 0, first.files_owned_ccp/second.files_owned_ccp, null)) as files_owned_ccp_std
, avg(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_avg	 , stddev(if(second.corrective_rate> 0, first.corrective_rate/second.corrective_rate, null)) as corrective_rate_std
, avg(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_avg	 , stddev(if(second.ccp> 0, first.ccp/second.ccp, null)) as ccp_std
, avg(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_avg	 , stddev(if(second.refactor_mle> 0, first.refactor_mle/second.refactor_mle, null)) as refactor_mle_std
, avg(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_avg	 , stddev(if(second.cursing_rate> 0, first.cursing_rate/second.cursing_rate, null)) as cursing_rate_std
, avg(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_avg	 , stddev(if(second.positive_sentiment_rate> 0, first.positive_sentiment_rate/second.positive_sentiment_rate, null)) as positive_sentiment_rate_std
, avg(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_avg	 , stddev(if(second.negative_sentiment_rate> 0, first.negative_sentiment_rate/second.negative_sentiment_rate, null)) as negative_sentiment_rate_std
, avg(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_avg	 , stddev(if(second.avg_coupling_size> 0, first.avg_coupling_size/second.avg_coupling_size, null)) as avg_coupling_size_std
, avg(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_avg	 , stddev(if(second.avg_coupling_code_size> 0, first.avg_coupling_code_size/second.avg_coupling_code_size, null)) as avg_coupling_code_size_std
, avg(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_avg	 , stddev(if(second.avg_coupling_size_capped> 0, first.avg_coupling_size_capped/second.avg_coupling_size_capped, null)) as avg_coupling_size_capped_std
, avg(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_avg	 , stddev(if(second.avg_coupling_code_size_capped> 0, first.avg_coupling_code_size_capped/second.avg_coupling_code_size_capped, null)) as avg_coupling_code_size_capped_std
, avg(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_avg	 , stddev(if(second.avg_coupling_size_cut> 0, first.avg_coupling_size_cut/second.avg_coupling_size_cut, null)) as avg_coupling_size_cut_std
, avg(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_avg	 , stddev(if(second.avg_coupling_code_size_cut> 0, first.avg_coupling_code_size_cut/second.avg_coupling_code_size_cut, null)) as avg_coupling_code_size_cut_std
, avg(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_avg	 , stddev(if(second.tests_presence> 0, first.tests_presence/second.tests_presence, null)) as tests_presence_std
, avg(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_avg	 , stddev(if(second.multiline_message_ratio> 0, first.multiline_message_ratio/second.multiline_message_ratio, null)) as multiline_message_ratio_std
, avg(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_avg	 , stddev(if(second.message_length_avg> 0, first.message_length_avg/second.message_length_avg, null)) as message_length_avg_std
, avg(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_avg	 , stddev(if(second.corrective_multiline_message_ratio> 0, first.corrective_multiline_message_ratio/second.corrective_multiline_message_ratio, null)) as corrective_multiline_message_ratio_std
, avg(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_avg	 , stddev(if(second.corrective_message_length_avg> 0, first.corrective_message_length_avg/second.corrective_message_length_avg, null)) as corrective_message_length_avg_std
, avg(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_avg	 , stddev(if(second.non_corrective_multiline_message_ratio> 0, first.non_corrective_multiline_message_ratio/second.non_corrective_multiline_message_ratio, null)) as non_corrective_multiline_message_ratio_std
, avg(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_avg	 , stddev(if(second.non_corrective_message_length_avg> 0, first.non_corrective_message_length_avg/second.non_corrective_message_length_avg, null)) as non_corrective_message_length_avg_std
, avg(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_avg	 , stddev(if(second.duplicated_commits_ratio> 0, first.duplicated_commits_ratio/second.duplicated_commits_ratio, null)) as duplicated_commits_ratio_std
, avg(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_avg	 , stddev(if(second.self_from_all_ratio> 0, first.self_from_all_ratio/second.self_from_all_ratio, null)) as self_from_all_ratio_std
, avg(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_avg	 , stddev(if(second.same_date_duration_avg> 0, first.same_date_duration_avg/second.same_date_duration_avg, null)) as same_date_duration_avg_std
, avg(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_avg	 , stddev(if(second.same_date_commits> 0, first.same_date_commits/second.same_date_commits, null)) as same_date_commits_std
, avg(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_avg	 , stddev(if(second.commit_period> 0, first.commit_period/second.commit_period, null)) as commit_period_std
, avg(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_avg	 , stddev(if(second.commits_per_day> 0, first.commits_per_day/second.commits_per_day, null)) as commits_per_day_std
, avg(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_avg	 , stddev(if(second.commit_days> 0, first.commit_days/second.commit_days, null)) as commit_days_std
, avg(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_avg	 , stddev(if(second.commit_weeks> 0, first.commit_weeks/second.commit_weeks, null)) as commit_weeks_std
, avg(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_avg	 , stddev(if(second.commit_months> 0, first.commit_months/second.commit_months, null)) as commit_months_std
, avg(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_avg	 , stddev(if(second.commit_days_of_week> 0, first.commit_days_of_week/second.commit_days_of_week, null)) as commit_days_of_week_std
, avg(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_avg	 , stddev(if(second.commit_hours> 0, first.commit_hours/second.commit_hours, null)) as commit_hours_std
, avg(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_avg	 , stddev(if(second.commit_day_density> 0, first.commit_day_density/second.commit_day_density, null)) as commit_day_density_std
, avg(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_avg	 , stddev(if(second.Sunday_prob> 0, first.Sunday_prob/second.Sunday_prob, null)) as Sunday_prob_std
, avg(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_avg	 , stddev(if(second.Monday_prob> 0, first.Monday_prob/second.Monday_prob, null)) as Monday_prob_std
, avg(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_avg	 , stddev(if(second.Tuesday_prob> 0, first.Tuesday_prob/second.Tuesday_prob, null)) as Tuesday_prob_std
, avg(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_avg	 , stddev(if(second.Wednesday_prob> 0, first.Wednesday_prob/second.Wednesday_prob, null)) as Wednesday_prob_std
, avg(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_avg	 , stddev(if(second.Thursday_prob> 0, first.Thursday_prob/second.Thursday_prob, null)) as Thursday_prob_std
, avg(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_avg	 , stddev(if(second.Friday_prob> 0, first.Friday_prob/second.Friday_prob, null)) as Friday_prob_std
, avg(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_avg	 , stddev(if(second.Saturday_prob> 0, first.Saturday_prob/second.Saturday_prob, null)) as Saturday_prob_std
, avg(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_avg	 , stddev(if(second.days_entropy> 0, first.days_entropy/second.days_entropy, null)) as days_entropy_std
, avg(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_avg	 , stddev(if(second.hour_entropy> 0, first.hour_entropy/second.hour_entropy, null)) as hour_entropy_std
, avg(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_avg	 , stddev(if(second.avg_file_size> 0, first.avg_file_size/second.avg_file_size, null)) as avg_file_size_std
, avg(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_avg	 , stddev(if(second.capped_avg_file_size> 0, first.capped_avg_file_size/second.capped_avg_file_size, null)) as capped_avg_file_size_std
, avg(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_avg	 , stddev(if(second.avg_code_file_size> 0, first.avg_code_file_size/second.avg_code_file_size, null)) as avg_code_file_size_std
, avg(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_avg	 , stddev(if(second.capped_avg_code_file_size> 0, first.capped_avg_code_file_size/second.capped_avg_code_file_size, null)) as capped_avg_code_file_size_std
, avg(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_avg	 , stddev(if(second.sum_file_size> 0, first.sum_file_size/second.sum_file_size, null)) as sum_file_size_std
, avg(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_avg	 , stddev(if(second.capped_sum_file_size> 0, first.capped_sum_file_size/second.capped_sum_file_size, null)) as capped_sum_file_size_std
, avg(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_avg	 , stddev(if(second.sum_code_file_size> 0, first.sum_code_file_size/second.sum_code_file_size, null)) as sum_code_file_size_std
, avg(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_avg	 , stddev(if(second.capped_sum_code_file_size> 0, first.capped_sum_code_file_size/second.capped_sum_code_file_size, null)) as capped_sum_code_file_size_std
, avg(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_avg	 , stddev(if(second.prev_touch_ago> 0, first.prev_touch_ago/second.prev_touch_ago, null)) as prev_touch_ago_std
, avg(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_avg	 , stddev(if(second.bug_prev_touch_ago> 0, first.bug_prev_touch_ago/second.bug_prev_touch_ago, null)) as bug_prev_touch_ago_std
, avg(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_avg	 , stddev(if(second.same_day_duration_avg> 0, first.same_day_duration_avg/second.same_day_duration_avg, null)) as same_day_duration_avg_std
, avg(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_avg	 , stddev(if(second.one_file_fix_rate> 0, first.one_file_fix_rate/second.one_file_fix_rate, null)) as one_file_fix_rate_std
, avg(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_avg	 , stddev(if(second.one_file_refactor_rate> 0, first.one_file_refactor_rate/second.one_file_refactor_rate, null)) as one_file_refactor_rate_std
, avg(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_avg	 , stddev(if(second.test_usage_rate> 0, first.test_usage_rate/second.test_usage_rate, null)) as test_usage_rate_std
, avg(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_avg	 , stddev(if(second.test_usage_in_refactor_rate> 0, first.test_usage_in_refactor_rate/second.test_usage_in_refactor_rate, null)) as test_usage_in_refactor_rate_std
, avg(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_avg	 , stddev(if(second.no_test_refactor_rate> 0, first.no_test_refactor_rate/second.no_test_refactor_rate, null)) as no_test_refactor_rate_std
, avg(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_avg	 , stddev(if(second.textual_abstraction_commits> 0, first.textual_abstraction_commits/second.textual_abstraction_commits, null)) as textual_abstraction_commits_std
, avg(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_avg	 , stddev(if(second.textual_abstraction_commits_rate> 0, first.textual_abstraction_commits_rate/second.textual_abstraction_commits_rate, null)) as textual_abstraction_commits_rate_std
, avg(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_avg	 , stddev(if(second.testing_involved_prob> 0, first.testing_involved_prob/second.testing_involved_prob, null)) as testing_involved_prob_std
, avg(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_avg	 , stddev(if(second.corrective_testing_involved_prob> 0, first.corrective_testing_involved_prob/second.corrective_testing_involved_prob, null)) as corrective_testing_involved_prob_std
, avg(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_avg	 , stddev(if(second.refactor_testing_involved_prob> 0, first.refactor_testing_involved_prob/second.refactor_testing_involved_prob, null)) as refactor_testing_involved_prob_std
, avg(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_avg	 , stddev(if(second.abs_content_ratio> 0, first.abs_content_ratio/second.abs_content_ratio, null)) as abs_content_ratio_std
, avg(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_avg	 , stddev(if(second.minutes_to_revert> 0, first.minutes_to_revert/second.minutes_to_revert, null)) as minutes_to_revert_std
, avg(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_avg	 , stddev(if(second.reverted_ratio> 0, first.reverted_ratio/second.reverted_ratio, null)) as reverted_ratio_std
, avg(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_avg	 , stddev(if(second.performance_rate> 0, first.performance_rate/second.performance_rate, null)) as performance_rate_std
, avg(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_avg	 , stddev(if(second.security_rate> 0, first.security_rate/second.security_rate, null)) as security_rate_std
, avg(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_avg	 , stddev(if(second.author_id> 0, first.author_id/second.author_id, null)) as author_id_std
, avg(if(second.issues> 0, first.issues/second.issues, null)) as issues_avg	 , stddev(if(second.issues> 0, first.issues/second.issues, null)) as issues_std
, avg(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_avg	 , stddev(if(second.assigned_issues> 0, first.assigned_issues/second.assigned_issues, null)) as assigned_issues_std
, avg(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_avg	 , stddev(if(second.assigned_issues_ratio> 0, first.assigned_issues_ratio/second.assigned_issues_ratio, null)) as assigned_issues_ratio_std
, avg(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_avg	 , stddev(if(second.closed_issues> 0, first.closed_issues/second.closed_issues, null)) as closed_issues_std
, avg(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_avg	 , stddev(if(second.closed_issues_ratio> 0, first.closed_issues_ratio/second.closed_issues_ratio, null)) as closed_issues_ratio_std
, avg(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_avg	 , stddev(if(second.merged_issues> 0, first.merged_issues/second.merged_issues, null)) as merged_issues_std
, avg(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_avg	 , stddev(if(second.merged_issues_ratio> 0, first.merged_issues_ratio/second.merged_issues_ratio, null)) as merged_issues_ratio_std
, avg(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_avg	 , stddev(if(second.reopened_issues> 0, first.reopened_issues/second.reopened_issues, null)) as reopened_issues_std
, avg(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_avg	 , stddev(if(second.reopened_issues_ratio> 0, first.reopened_issues_ratio/second.reopened_issues_ratio, null)) as reopened_issues_ratio_std
, avg(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_avg	 , stddev(if(second.milestoned_issues> 0, first.milestoned_issues/second.milestoned_issues, null)) as milestoned_issues_std
, avg(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_avg	 , stddev(if(second.milestoned_issues_ratio> 0, first.milestoned_issues_ratio/second.milestoned_issues_ratio, null)) as milestoned_issues_ratio_std
, avg(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_avg	 , stddev(if(second.demilestoned_issues> 0, first.demilestoned_issues/second.demilestoned_issues, null)) as demilestoned_issues_std
, avg(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_avg	 , stddev(if(second.demilestoned_issues_ratio> 0, first.demilestoned_issues_ratio/second.demilestoned_issues_ratio, null)) as demilestoned_issues_ratio_std
, avg(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_avg	 , stddev(if(second.assigned_to_closed_minutes> 0, first.assigned_to_closed_minutes/second.assigned_to_closed_minutes, null)) as assigned_to_closed_minutes_std
, avg(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_avg	 , stddev(if(second.created_to_assigned_minutes> 0, first.created_to_assigned_minutes/second.created_to_assigned_minutes, null)) as created_to_assigned_minutes_std
, avg(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_avg	 , stddev(if(second.created_to_closed_minutes> 0, first.created_to_closed_minutes/second.created_to_closed_minutes, null)) as created_to_closed_minutes_std
, avg(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_avg	 , stddev(if(second.pull_requests> 0, first.pull_requests/second.pull_requests, null)) as pull_requests_std
, avg(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_avg	 , stddev(if(second.opened_prs> 0, first.opened_prs/second.opened_prs, null)) as opened_prs_std
, avg(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_avg	 , stddev(if(second.opened_pr_ratio> 0, first.opened_pr_ratio/second.opened_pr_ratio, null)) as opened_pr_ratio_std
, avg(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_avg	 , stddev(if(second.closed_prs> 0, first.closed_prs/second.closed_prs, null)) as closed_prs_std
, avg(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_avg	 , stddev(if(second.closed_pr_ratio> 0, first.closed_pr_ratio/second.closed_pr_ratio, null)) as closed_pr_ratio_std
, avg(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_avg	 , stddev(if(second.merged_prs> 0, first.merged_prs/second.merged_prs, null)) as merged_prs_std
, avg(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_avg	 , stddev(if(second.merged_pr_ratio> 0, first.merged_pr_ratio/second.merged_pr_ratio, null)) as merged_pr_ratio_std
, avg(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_avg	 , stddev(if(second.first_to_last_commit_minutes> 0, first.first_to_last_commit_minutes/second.first_to_last_commit_minutes, null)) as first_to_last_commit_minutes_std
, avg(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_avg	 , stddev(if(second.open_to_merge_minutes> 0, first.open_to_merge_minutes/second.open_to_merge_minutes, null)) as open_to_merge_minutes_std
, avg(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_avg	 , stddev(if(second.first_commit_to_merge_minutes> 0, first.first_commit_to_merge_minutes/second.first_commit_to_merge_minutes, null)) as first_commit_to_merge_minutes_std
, avg(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_avg	 , stddev(if(second.sloppy_pr_ratio> 0, first.sloppy_pr_ratio/second.sloppy_pr_ratio, null)) as sloppy_pr_ratio_std
from
general.developer_motivation_profile as first
join
general.developer_motivation_profile as second
on
first.author_email = second.author_email
and
first.year +1 = second.year
and
first.repo_name = second.repo_name
where
second.status = 'Abandoned'
;

